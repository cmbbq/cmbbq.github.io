<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>misc on Cmbbq&#39;s Encyclopedia</title>
    <link>https://cmbbq.github.io/tags/misc/</link>
    <description>Recent content in misc on Cmbbq&#39;s Encyclopedia</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <lastBuildDate>Thu, 16 May 2024 00:00:00 +0000</lastBuildDate><atom:link href="https://cmbbq.github.io/tags/misc/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title> 护照网上换发攻略</title>
      <link>https://cmbbq.github.io/posts/passport-photo-compliance/</link>
      <pubDate>Thu, 16 May 2024 00:00:00 +0000</pubDate>
      
      <guid>https://cmbbq.github.io/posts/passport-photo-compliance/</guid>
      <description>2024年5月6日起，20城试点网上护照换发，正好需要更新护照，记录一下网上换发的流程。
护照网上换发流程 申请护照换发的网上入口：微信小程序-国家移民管理局政务服务平台-中国公民服务-证件换补发网上申请。
需提前准备好护照照片、签名照片、身份证照片。完成申请后，等待审批，审批通过后支持工本费，寄到家中到付。
照片合规处理 护照照片有严格的规格要求：格式为jpeg，20k~80k，宽高比3:4，图像大小(354,472)~(480,640)，以及一些隐式要求，如头部占比需足够大、头顶需有一定留白。
写了一个工具来处理。这个工具同样适用于签名照片和身份证照片，因为这两个照片也有尺寸的要求。
from PIL import Image, ImageOps import argparse def Config(parser): parser.add_argument(&amp;#39;-i&amp;#39;, dest=&amp;#39;input&amp;#39;, default=&amp;#34;./in.jpg&amp;#34;, help=&amp;#39;input photo path&amp;#39;) parser.add_argument(&amp;#39;-o&amp;#39;, dest=&amp;#39;output&amp;#39;, default=&amp;#34;./out.jpg&amp;#34;, help=&amp;#39;input photo path&amp;#39;) parser.add_argument(&amp;#39;--height&amp;#39;, dest=&amp;#39;height&amp;#39;, default=640, help=&amp;#39;desired output height&amp;#39;) parser.add_argument(&amp;#39;--width&amp;#39;, dest=&amp;#39;width&amp;#39;, default=480, help=&amp;#39;desired output width&amp;#39;) parser.add_argument(&amp;#39;--crop_ratio&amp;#39;, dest=&amp;#39;crop_ratio&amp;#39;,type=float, default=0.8, help=&amp;#39;crop_ratio = cropped_size/original_size&amp;#39;) parser.add_argument(&amp;#39;--crop_xoff&amp;#39;, dest=&amp;#39;crop_xoff&amp;#39;, type=float, default=0.5, help=&amp;#39;0: left-aligned, 0.5: mid, 1: right-aligned&amp;#39;) parser.add_argument(&amp;#39;--crop_yoff&amp;#39;, dest=&amp;#39;crop_yoff&amp;#39;, type=float, default=0.5, help=&amp;#39;0: up-aligned, 0.5: mid, 1: down-aligned&amp;#39;) return parser.parse_args() if __name__ == &amp;#39;__main__&amp;#39;: args = Config(argparse.</description>
      <content>&lt;p&gt;2024年5月6日起，20城试点网上护照换发，正好需要更新护照，记录一下网上换发的流程。&lt;/p&gt;
&lt;h2 id=&#34;护照网上换发流程&#34;&gt;护照网上换发流程&lt;/h2&gt;
&lt;p&gt;申请护照换发的网上入口：微信小程序-国家移民管理局政务服务平台-中国公民服务-证件换补发网上申请。&lt;/p&gt;
&lt;p&gt;需提前准备好护照照片、签名照片、身份证照片。完成申请后，等待审批，审批通过后支持工本费，寄到家中到付。&lt;/p&gt;
&lt;h2 id=&#34;照片合规处理&#34;&gt;照片合规处理&lt;/h2&gt;
&lt;p&gt;护照照片有严格的规格要求：格式为jpeg，20k~80k，宽高比3:4，图像大小(354,472)~(480,640)，以及一些隐式要求，如头部占比需足够大、头顶需有一定留白。&lt;/p&gt;
&lt;p&gt;写了一个工具来处理。这个工具同样适用于签名照片和身份证照片，因为这两个照片也有尺寸的要求。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;from&lt;/span&gt; PIL &lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; Image, ImageOps
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; argparse
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Config&lt;/span&gt;(parser):
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  parser&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;add_argument(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;-i&amp;#39;&lt;/span&gt;, dest&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;input&amp;#39;&lt;/span&gt;, default&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;./in.jpg&amp;#34;&lt;/span&gt;, help&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;input photo path&amp;#39;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  parser&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;add_argument(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;-o&amp;#39;&lt;/span&gt;, dest&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;output&amp;#39;&lt;/span&gt;, default&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;./out.jpg&amp;#34;&lt;/span&gt;, help&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;input photo path&amp;#39;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  parser&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;add_argument(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;--height&amp;#39;&lt;/span&gt;, dest&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;height&amp;#39;&lt;/span&gt;, default&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;640&lt;/span&gt;, help&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;desired output height&amp;#39;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  parser&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;add_argument(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;--width&amp;#39;&lt;/span&gt;, dest&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;width&amp;#39;&lt;/span&gt;, default&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;480&lt;/span&gt;, help&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;desired output width&amp;#39;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  parser&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;add_argument(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;--crop_ratio&amp;#39;&lt;/span&gt;, dest&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;crop_ratio&amp;#39;&lt;/span&gt;,type&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;float, default&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.8&lt;/span&gt;, help&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;crop_ratio = cropped_size/original_size&amp;#39;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  parser&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;add_argument(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;--crop_xoff&amp;#39;&lt;/span&gt;, dest&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;crop_xoff&amp;#39;&lt;/span&gt;, type&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;float, default&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.5&lt;/span&gt;, help&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;0: left-aligned, 0.5: mid, 1: right-aligned&amp;#39;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  parser&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;add_argument(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;--crop_yoff&amp;#39;&lt;/span&gt;, dest&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;crop_yoff&amp;#39;&lt;/span&gt;, type&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;float, default&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.5&lt;/span&gt;, help&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;0: up-aligned, 0.5: mid, 1: down-aligned&amp;#39;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; parser&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;parse_args()
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; __name__ &lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;__main__&amp;#39;&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  args &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Config(argparse&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;ArgumentParser())
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#66d9ef&#34;&gt;with&lt;/span&gt; Image&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;open(args&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;input) &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; im:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    width, height &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; im&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;size
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    cropped_width &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; args&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;crop_ratio &lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt; width
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    cropped_height &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; args&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;crop_ratio &lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt; height
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    xdiff &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; width &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt; cropped_width
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    ydiff &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; height &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt; cropped_height
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    xoff &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; xdiff &lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt; args&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;crop_xoff
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    yoff &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; ydiff &lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt; args&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;crop_yoff
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    box &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; (xoff, yoff, width &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt; xdiff &lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt; xoff, height &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt; ydiff &lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt; yoff)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    print(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;input file &lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;{}&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;: original size = (&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;{}&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;,&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;{}&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;), cropped size = (&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;{}&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;,&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;{}&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;), cropped region=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;{}&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;, desired size = (&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;{}&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;,&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;{}&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;)&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;format(args&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;input, width, height, cropped_width, cropped_height, box, args&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;width, args&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;height))
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    cropped &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; im&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;crop(box)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    desired_size &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; (args&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;width, args&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;height)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    ImageOps&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;fit(cropped, desired_size)&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;save(args&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;output)
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</content>
    </item>
    
  </channel>
</rss>
